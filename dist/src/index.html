<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <title>Garage Database Interface</title>
  <!-- Favicon -->
  <link rel="icon" href="img/Garage.ico" type="image/x-icon" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
  <!-- Google Fonts Roboto -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" />
  <!-- Main css file -->
  <link rel="stylesheet" href="css/index.min.css" />
  <!-- Custom styles -->

  <script src="https://cesium.com/downloads/cesiumjs/releases/1.95/Build/Cesium/Cesium.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js"></script>

  <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.1/css/dataTables.bootstrap5.min.css" />




  <style>
    .gradient-custom {
      /* fallback for old browsers */
      background: #a18cd1;

      /* Chrome 10-25, Safari 5.1-6 */
      background: -webkit-linear-gradient(45deg,
          rgba(29, 236, 197, 0.6),
          rgba(91, 14, 214, 0.6) 100%);

      /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
      background: linear-gradient(45deg,
          rgba(29, 236, 197, 0.6),
          rgba(91, 14, 214, 0.6) 100%);
    }

    #card-background {
      background: rgba(255, 255, 255, 0.55);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      backdrop-filter: blur(3.5px);
      -webkit-backdrop-filter: blur(3.5px);
      border-radius: 15px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      max-width: 95vw;
      max-height: 95vh;
      overflow-y: auto;
    }

    .highlight-card {
      background: rgba(37, 37, 37, 0.05);
      box-shadow: 0 8px 32px 0 rgba(46, 48, 77, 0.001);
      border-radius: 15px;
      border: 1px solid rgba(232, 232, 232, 0.18);
      max-width: 95vw;
      max-height: 95vh;
      padding: 1rem;
      margin-top: 1rem;
      margin-bottom: 1rem;
    }

    .btn-primary {
      margin-bottom: 2rem;
    }

    .input-field {
      background: rgba(255, 255, 255, 0.55);
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      border-radius: 5px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      font-size: 1.5rem;
      width:100%;
      
    }

    .input-label {
      font-size: 1.5rem;
    }

    .table{
      width: 100%;
    }
  </style>
</head>

<body>
  <!-- Start your project here-->


  <div class="bg-image" style="
    background-image: url('../src/img/Background.jpg');
    height: 100vh;
  ">
    <div class="mask gradient-custom">
      <div class="d-flex justify-content-center align-items-center h-100">
        <div id="card-background" class="p-3 mb-2 text-dark">
          <div style="margin: 2rem;">
            <h1>Garage Database</h1>
            <div id="main-row" class="row">
              <div style="width: 45%; min-width: 18rem;">
                <div class="highlight-card">

                <label for="matric" class="input-label">Matric Number:</label><br />
                <input type="text" id="matric" name="matric" class="input-field"><br />
                <label for="passcode" class="input-label">Passcode:</label><br />
                <input type="password" id="passcode" name="passcode" class="input-field"><br />
                <br />
                <button type="button" onclick="getData(this)" class="btn btn-primary">
                  <span id="loading-icon" class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                  Search
                </button>
                <br />
              </div>
              </div>
              <div id="position-label" style="width: 55%; min-width: 18rem;">
                <div  class="highlight-card">
                  <h4>Position</h4>
                  <h3 id="position-output">
                </div>
              </div>
              <br/>
              <h5>
                You can access useful links and active projects <a href="https://docs.google.com/spreadsheets/d/1NySf7f0fnP1B3ovtn0MUM01i6ETc7FWDXXrSXU1ilGM/edit#gid=0" target="_blank">here</a>, through the Garage ambassador handbook
              </h5>
              <div id="event-data" style="overflow-x:auto;">
                <br />
                <hr class="rounded">
                <h4>Event Data</h4>
                <table id="event-data-table" class="table table-striped">
                  <thead>
                    <tr>
                      <th>Event Name</th>
                      <th>Event Date</th>
                      <th>Description</th>
                      <th>Event Position</th>
                    </tr>
                  </thead>
                  <tbody>
                  </tbody>
              </div>

            </div>
          </div>

        </div>
      </div>
    </div>
    <!-- End your project here-->
</body>
<!-- Main js file -->
<script type="text/javascript" src="js/index.min.js"></script>
<!-- Custom scripts -->


</html>

<script type="text/javascript">
  var table;
  document.getElementById("event-data").style.display = "none";
  document.getElementById("position-label").style.display = "none";
  document.getElementById("loading-icon").style.display = "none";
  document.getElementById("main-row").style.display = "inline-block";

  $(document).ready(function () {
    table = $('#event-data-table').DataTable({
      ordering: true,
      info: true,
      stripe: true,
      autoWidth: false,


    });

    //t.row.add(['test1', 'test2', 'test3', 'test4']).draw(true);

  });

  function getData() {
    document.getElementById("loading-icon").style.display = "";
    table.clear().draw();
    document.getElementById("event-data").style.display = "none";
    var matric = document.getElementById("matric").value;
    var passcode = document.getElementById("passcode").value;
    //alert(matric);

    var url = "https://script.google.com/macros/s/AKfycbzXoLUWrI9Q1BPyCkPWojd4w4qlyLm2gMYe1JeG0eTPleEXmSP097KDLeP8ONLiBU23/exec?Matric=" + matric + "&Passcode=" + passcode;
    fetch(url, { method: 'GET', redirect: 'follow' })
      .then((response) => response.json())
      .then((data) => {
        document.getElementById("position-label").style.display = "";
        document.getElementById('position-output').innerHTML = data['portfolio'];

        if (data.hasOwnProperty('event_details')) {
          document.getElementById("event-data").style.display = "";
          data['event_details'].forEach((event, i) => {
            var parsedDate = new Date(Date.parse(event['event_date']));
            var formattedDate = parsedDate.toLocaleDateString('en-GB');
            table.row.add([event['event_name'], formattedDate, event['event_description'], event['event_position']]).draw(false);
          });
        }
        document.getElementById("loading-icon").style.display = "none";
        document.getElementById("main-row").style.display = "";

      }
      );

  }
</script>